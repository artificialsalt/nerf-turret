<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nerf-turret: nerf-turret</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nerf-turret<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">Infrared targeting nerf turret</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">nerf-turret </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Jackie Chen, Richard Kwan, Chayton Ritter </dd></dl>
<dl class="section date"><dt>Date</dt><dd>14-Mar-2023</dd></dl>
<h1><a class="anchor" id="soft_org"></a>
Software Organization</h1>
<dl class="section user"><dt></dt><dd>The following files are included in this software:<br  />
<br  />
<a class="el" href="main_8py.html" title="This file contains code to perform a nerf turret duel.">main.py</a>: The main turret duel program<br  />
<a class="el" href="mlx__cam_8py.html" title="RAW VERSION This version uses a stripped down MLX90640 driver which produces only raw data,...">mlx_cam.py</a>: A driver for the MLX90640 camera<br  />
mlx90640: A folder containing dependencies required to run the MLX90640 camera driver<br  />
<a class="el" href="motor__driver_8py.html" title="This file contains a class that allows the user to instantiate a motor driver.">motor_driver.py</a>: A library containing a class for a motor driver<br  />
<a class="el" href="servo__driver_8py.html" title="This file contains a class that allows the user to instantiate a servo driver.">servo_driver.py</a>: A library containing a class for a servo driver<br  />
<a class="el" href="encoder__reader_8py.html" title="This file contains a class that allows the user to instantiate a motor encoder.">encoder_reader.py</a>: A library containing a class for an encoder reader<br  />
<a class="el" href="closedloopcontrol_8py.html" title="This file contains a class that allows the user to instantiate a proportional controller for a motor.">closedloopcontrol.py</a>: A library containing a class for a proportional system controller</dd></dl>
<h1><a class="anchor" id="tasks"></a>
Tasks</h1>
<dl class="section user"><dt></dt><dd>The turret code can be summarized as a list of tasks:</dd></dl>
<dl class="section user"><dt></dt><dd><ol type="1">
<li>Adjusting the blaster horizontally<br  />
</li>
<li>Adjusting the blaster vertically<br  />
</li>
<li>Shooting a dart<br  />
</li>
<li>Detecting a target (aiming)</li>
</ol>
</dd></dl>
<dl class="section user"><dt></dt><dd>Although the intent of this project was to have these tasks run pseudo-simultaneously using a task-sharing algorithm, this was ommitted due to the almost mutually exclusive nature of these tasks, which can be attributed to the following:</dd></dl>
<dl class="section user"><dt></dt><dd><ul>
<li>The original design having the camera mounted directly on the blaster. Due to refresh rate constraints, an image could not be taken until the blaster was stationary. The change to a camera mounted separate from the turret was done at the last minute, so the code was not changed to reflect the new ability to take an image while moving.<br  />
</li>
<li>The blaster not being able to move until the aiming point was calculated. Calculating the aiming point was a computationally expensive task, taking at least half a second to complete. There was no benefit to making this task a generator, as the motors would remain stationary until the new setpoints were calculated. If the code was updated to reflect the new ability to take an image while the turret was moving, then this calculation could still occur during a movement phase.<br  />
 </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>As a result, the only tasks that can be considered "shared" at any given point are the vertical and horizontal adjustments.<br  />
<br  />
The task diagram is shown below.</dd></dl>
<div class="image">
<img src="405_td.png" alt=""/>
</div>
<h1><a class="anchor" id="state_dia"></a>
State Structure</h1>
<dl class="section user"><dt></dt><dd>The main duel program is organized into six distinct states:</dd></dl>
<dl class="section user"><dt></dt><dd>S0_INIT: The turret initializes all necessary internal variables.<br  />
S1_TURN180: The turret turns 180 degrees. It stays in this state until 5 seconds have passed. This state consists of both move tasks.<br  />
S2_AIM: The turret takes a picture using the infrared camera, processes the image, and calculates the necessary movement to aim at the target. This state consists exclusively of the target detection task.<br  />
S3_ADJUST: The turret moves according to the calculations in the AIM state. The turret stays in this state for 500 milliseconds. This state consists of both move tasks.<br  />
S4_SHOOT: The turret spins up the flywheels, then actuates a servo to push a loaded dart into the flywheels. This state consists exclusively of the shoot task.<br  />
S5_SAFE: The turret powers down. All motors are disabled and the trigger mechanism is returned to the original position.</dd></dl>
<dl class="section user"><dt></dt><dd>The state diagram is shown below.</dd></dl>
<div class="image">
<img src="405_sd.png" alt=""/>
</div>
 </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
